{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '43801311-7231ce11da623161c2dfbe05c';\n\nasync function searchImages(query, page = 1, per_page = 15) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page,\n    page,\n  });\n\n  const { data } = await axios.get(`${BASE_URL}?${params}`);\n  // console.log('data', data);\n\n  return data;\n}\n\nexport { searchImages };\n","function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\">\n          </a>\n          <ul class=\"gallery-description-list\">\n            <li class=\"gallery-description-item\">\n              <p class=\"gallery-description-headline\">Likes</p>\n              <p class=\"gallery-description-quantity\">${likes}</p>\n            </li>\n            <li class=\"gallery-description-item\">\n              <p class=\"gallery-description-headline\">Views</p>\n              <p class=\"gallery-description-quantity\">${views}</p>\n            </li>\n            <li class=\"gallery-description-item\">\n              <p class=\"gallery-description-headline\">Comments</p>\n              <p class=\"gallery-description-quantity\">${comments}</p>\n            </li>\n            <li class=\"gallery-description-item\">\n              <p class=\"gallery-description-headline\">Downloads</p>\n              <p class=\"gallery-description-quantity\">${downloads}</p>\n            </li>\n          </ul>\n        </li>\n        `;\n      }\n    )\n    .join('');\n}\n/* <- */\n\nexport { createMarkup };\n","/* ----- axios ----- */\nimport axios from 'axios';\n\n/* ----- iziToast ----- */\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n/* ----- SimpleLightbox ----- */\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n/* ----- JS ----- */\nimport { searchImages } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\nimport Container from 'postcss/lib/container'; // ???\n\nconst lightbox = new SimpleLightbox('.gallery-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst form = document.querySelector('.js-search-form');\nconst gallery = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-more');\n\nlet page = 1;\nlet per_page = 15;\nlet totalHits = 0;\nlet query = '';\n\n//=============================================================\n\nform.addEventListener('submit', handleSearch);\nloadBtn.addEventListener('click', loadMore);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  gallery.innerHTML = '';\n  loadBtn.disabled = false;\n  loadBtn.classList.replace('load-more', 'load-more-hidden');\n  page = 1;\n\n  query = event.target.elements.search.value.trim();\n\n  if (query.trim() === '') {\n    loadBtn.disabled = true;\n    loadBtn.classList.replace('load-more', 'load-more-hidden');\n    warningMessage();\n    return;\n  }\n\n  loader.classList.replace('loader-on', 'loader'); //Loader on\n\n  searchImages(query, page)\n    .then(data => {\n      loader.classList.replace('loader', 'loader-on'); //Loader off\n      loadBtn.classList.replace('load-more-hidden', 'load-more');\n\n      if (data.hits.length === 0) {\n        noMessage();\n        loadBtn.classList.replace('load-more', 'load-more-hidden');\n        return;\n      }\n\n      form.reset();\n      gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n\n      if (page === 1) totalHits = data.totalHits;\n\n      if (page * per_page >= totalHits) {\n        loadBtn.classList.replace('load-more-hidden', 'load-more');\n      }\n\n      console.log(totalHits);\n\n      if (totalHits < per_page) {\n        loadBtn.classList.replace('load-more', 'load-more-hidden');\n        infoMessage();\n      }\n\n      lightbox.refresh();\n      form.reset();\n    })\n    .catch(error => alert(error.message));\n\n  gallery.innerHTML = '';\n}\n\nasync function loadMore() {\n  page += 1;\n  loadBtn.disabled = true;\n\n  loader.classList.replace('loader', 'loader-on'); //Loader off\n\n  try {\n    const data = await searchImages(query, page);\n    gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    lightbox.refresh();\n\n    loadBtn.disabled = false;\n\n    const item = document.querySelector('.gallery-item');\n    const itemHeight = item.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: itemHeight * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n\n    if (page * per_page >= totalHits) {\n      loadBtn.disabled = false;\n      loadBtn.classList.replace('load-more', 'load-more-hidden');\n      infoMessage();\n      loader.classList.replace('loader-on', 'loader'); //Loader on\n    }\n  } catch (error) {\n    iziToast.show({\n      message: `${error}`,\n    });\n  } finally {\n    loadBtn.disabled = false;\n    loader.classList.replace('loader', 'loader-on'); //Loader off\n  }\n}\n\n/* ---------------------- iziToast ---------------------- */\nfunction infoMessage() {\n  iziToast.info({\n    title: 'We are sorry, ',\n    message: `but you've reached the end of search results.`,\n    titleSize: '16px',\n    position: 'topRight',\n    timeout: '5000',\n    closeOnClick: 'true',\n    progressBarColor: '#fff',\n    transitionIn: 'bounceInDown',\n    transitionOut: 'fadeOutRight',\n  });\n}\n\nfunction warningMessage() {\n  iziToast.warning({\n    title: 'Caution',\n    message: `Search field cannot be empty!`,\n    titleSize: '16px',\n    position: 'topRight',\n    timeout: '5000',\n    closeOnClick: 'true',\n    progressBarColor: '#fff',\n    transitionIn: 'bounceInDown',\n    transitionOut: 'fadeOutRight',\n  });\n}\n\nfunction noMessage() {\n  iziToast.error({\n    title: 'Sorry, ',\n    message: `there is no result for your request!`,\n    titleSize: '16px',\n    position: 'topRight',\n    timeout: '5000',\n    closeOnClick: 'true',\n    progressBarColor: '#fff',\n    transitionIn: 'bounceInDown',\n    transitionOut: 'fadeOutRight',\n  });\n}\n"],"names":["BASE_URL","API_KEY","searchImages","query","page","per_page","params","data","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","form","gallery","loader","loadBtn","totalHits","handleSearch","loadMore","event","warningMessage","noMessage","infoMessage","error","itemHeight","iziToast"],"mappings":"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"}